!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).UseTheForm={},e.React)}(this,(function(e,r){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(r);function u(){return(u=Object.assign||function(e){for(var r=1;arguments.length>r;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function a(e,r){if(null==e)return{};var t,n,u={},a=Object.keys(e);for(n=0;a.length>n;n++)0>r.indexOf(t=a[n])&&(u[t]=e[t]);return u}function c(e,r,t){var n={};if("object"==typeof r&&null!==r)n=Object.keys(r).reduce((function(n,u){return t?n[e+"/"+u]=void 0:void 0!==r[u]&&(n[e+"/"+u]=r[u]),n}),{});else if("function"==typeof r){var u,a;n=t?((u={})[e]=void 0,u):((a={})[e]=r,a)}else if("boolean"==typeof r||null===r){var c,i,o=null===r?{type:"collection",isValid:r,counter:0}:{type:"field",isValid:r,counter:0};n=t?((c={})[e]=void 0,c):((i={})[e]=o,i)}return n}function i(e,t,n,a){void 0===a&&(a=!1);var i=r.useRef({}),s=r.useRef({}),l=r.useCallback((function(r,n,a){void 0!==e?e.updateValidatorsMap(t.current+"/"+r,n,a):s.current[r]=u({},s.current[r],{isValid:n,counter:a})}),[]),d=r.useCallback((function(){return Object.keys(s.current).forEach((function(e){var r=s.current[e].type;s.current[e].counter=0,s.current[e].isValid="collection"===r&&null})),s.current}),[]),f=r.useRef((function(r,o,l){(i.current=u({},i.current,c(r,o)),a&&(s.current=u({},s.current,c(r,l))),void 0!==t&&n.current&&void 0!==e)&&(a?e.addValidatorsAsync:e.addValidators)(t.current,i.current,s.current)})).current,v=r.useRef((function(r,n,l){void 0===l&&(l=!1);var d=u({},i.current,c(r,n,!0)),f=a?u({},s.current,c(r,l,!0)):{};void 0!==e?(i.current=d,s.current=f,(a?e.removeValidatorsAsync:e.removeValidators)(t.current,i.current,s.current)):(i.current=o(d),s.current=o(f))}));return[i,f,v.current,s,l,d]}function o(e){return Object.keys(e).forEach((function(r){void 0===e[r]&&delete e[r]})),e}function s(e,t,n){void 0===n&&(n="object");var u=r.useRef({}),a=r.useCallback((function(e,r){u.current[e]=r}),[]);return{unRegisterField:r.useCallback((function(r){var a,c,i,o,s;delete u.current[r],"array"===n&&(u.current=(s=(a=u.current)[o=(i=Object.keys(a))[i.length-1]],i.pop(),i.map((function(e){return a[e]})).reduce((function(e,r,t){return e[t]=r,e}),((c={})[o]=s,c)))),null==t||null==t.updateRegisteredField||t.updateRegisteredField(e.current,u.current)}),[]),mapFields:u,updateRegisteredField:a}}function l(e){return e.filter((function(e){return null!=e}))[0]}function d(e){void 0===e&&(e=[]);var t=r.useRef(void 0),n=r.useRef(null),u=r.useRef((function(r,u){var a=function(e,r,t){void 0===r&&(r=[]);var n=r.map((function(r){return r(e,t)})),u=n.every((function(e){return null==e}));return{checks:n,isValid:u}}(r,e,u),c=a.isValid,i=a.checks;return t.current=l(i),n.current={isValid:c,checks:i},c}));return{validationMsg:t,validationObj:n,validationFN:u}}function f(e,t){var n=r.useRef(void 0),u=r.useRef(null);return[r.useRef((function(r){var a=void 0===r?"":r,c=Date.now();return u.current=c,t({status:"asyncStart"}),new Promise((function(r,i){e(a).then((function(e){u.current===c?(n.current=e,t({status:"asyncSuccess",value:e}),r(e)):i("cancelled")})).catch((function(e){u.current===c?(n.current=e,t({status:"asyncError",value:e}),i(e)):i("cancelled")}))}))}))]}function v(e,r){var t=r.nameProp,n=r.value,a=r.removeMe,c=r.add,i=void 0!==c&&c,o=e.constructor===Array,s=o?e.slice():u({},e);return i&&o&&void 0!==s[t]?s.splice(t,0,n):s[t]=n,(a||null==n||n.constructor===Array&&n.every((function(e){return void 0===e}))||"object"==typeof n&&"File"!==n.constructor.name&&0===Object.keys(n).length||"string"==typeof n&&""===n)&&delete s[t],s}var y=function(e){return e};function m(e){return void 0===e&&(e=[]),"function"==typeof e?e:0===e.length?y:function(r,t,n){return e.reduce((function(e,r,u){return u>0?r(e,t,n):e}),e[0](r,t,n))}}var p={ON_RESET:"ON_RESET",READY:"READY",RESETTED:"RESETTED",ON_CHANGE:"ON_CHANGE",ON_INIT:"ON_INIT",ON_SUBMIT:"ON_SUBMIT",ON_INIT_ASYNC:"ON_INIT_ASYNC",ON_RUN_ASYNC:"ON_RUN_ASYNC",ON_ASYNC_END:"ON_ASYNC_END"},V="__$$USETHEFORM_DISPATCHER$$__",S="__$$USETHEFORM_VALIDATION$$__",b=function(e,r,t){return void 0===t&&(t="/"),e===S?r:(Array.isArray(e)?e:e.split(t)).reduce((function(e,r){return e&&e[r]}),r)},h=function(e,r){return Object.keys(e).reduce((function(t,n){var u=b(n,r);return e[n](u,r)&&t}),!0)},g=function(e){return Object.keys(e).filter((function(r){return"field"===e[r].type})).every((function(r){var t=e[r];return 1===t.counter&&t.isValid}))},E=function(e){return Object.keys(e).filter((function(r){return"field"===e[r].type})).every((function(r){var t=e[r],n=t.isValid,u=t.counter;return 0===u&&!n||1===u&&n}))},R=function e(r){return Object.keys(r).reduce((function(t,n){var u=r[n];if("function"==typeof u)t.push(u());else{var a=e(u);t.push.apply(t,a)}return t}),[])},A={},_=[];function C(e){var t=e.initialState,n=e.touched,c=e.onChange,o=void 0===c?y:c,l=e.onReset,V=void 0===l?y:l,C=e.onInit,N=void 0===C?y:C,k=e.onSubmit,O=void 0===k?y:k,I=e.onValidation,F=void 0===I?y:I,x=e.resetSyncErr,M=void 0===x?y:x,T=e.validators,P=void 0===T?_:T,j=e.resetAsyncErr,D=void 0===j?y:j,Y=e.asyncValidator,B=e.onAsyncValidation,U=void 0===B?y:B,w=e.reducers,H=e._getInitilaStateForm_,$=e._onMultipleForm_,G=e.name,q=e.action,L=r.useState((function(){return void 0===(e=t)&&(e={}),{state:e,isValid:!0,status:p.READY,pristine:!0,isSubmitting:!1,submitAttempts:0,submitted:0};var e})),z=L[0],J=L[1],K=r.useRef(z),Q=r.useRef(function(e,r,t){return"function"==typeof e&&"function"==typeof r&&"string"==typeof t}(H,$,G)).current,W=r.useCallback((function(e){var r=e.state,t=e.status,n=a(e,["state","status"]),c=t===p.ON_RESET?X.current.state:t===p.ON_INIT?A:K.current.state,i=t===p.READY||t===p.ON_SUBMIT?r:Ve(r,c,c);K.current=u({},n,{status:t,state:i}),J(K.current)}),[]),X=r.useRef(u({},z)),Z=r.useRef(!1),ee=r.useCallback((function(){return Z.current}),[]),re=i(void 0,void 0,Z),te=re[0],ne=re[1],ue=re[2],ae=d(P),ce=ae.validationMsg,ie=ae.validationObj,oe=ae.validationFN,se=f(Y,U)[0],le=i(void 0,void 0,Z,!0),de=le[0],fe=le[1],ve=le[2],ye=le[3],me=le[4],pe=le[5],Ve=r.useMemo((function(){return m(w)}),[]),Se=s(),be=Se.unRegisterField,he=Se.mapFields,ge=Se.updateRegisteredField,Ee=r.useCallback((function(e,r,t){void 0===t&&(t=!1);var n=v(K.current.state,{value:r,nameProp:e,removeMe:t});_e(n,!1)}),[]),Re=r.useCallback((function(e,r,t){if(Z.current){X.current.state=v(X.current.state,{isValid:t,nameProp:e});var n=v(K.current.state,{value:r,nameProp:e});_e(n,!1)}else{var u=v(X.current.state,{value:t,nameProp:e}),a=v(K.current.state,{value:r,nameProp:e});X.current.state=u,K.current.state=a}}),[]),Ae=r.useCallback((function(e,r){var t=r.initialState,n=r.removeInitial,u=v(K.current.state,{value:r.currentState,nameProp:e,removeMe:r.removeCurrent});X.current.state=v(X.current.state,{value:t,nameProp:e,removeMe:n}),_e(u)}),[]),_e=r.useCallback((function(e,r,t){void 0===t&&(t=p.ON_CHANGE);var n=void 0!==r?r:K.current.pristine,a=h(te.current,e)&&g(ye.current);W(u({},K.current,{state:e,isValid:a,pristine:n,status:t}))}),[]),Ce=r.useRef({}),Ne=r.useCallback((function(e,r){var t;Ce.current=u({},Ce.current,((t={})[e]=r,t))}),[]),ke=r.useCallback((function(e){delete Ce.current[e]}),[]),Oe=r.useCallback((function(){var e=Object.keys(Ce.current).reduce((function(e,r){var t=Ce.current[r](X.current.state);return void 0!==t&&(e[r]=t),e}),{}),r=pe(),t=h(te.current,e)&&g(r);W(u({},X.current,{state:e,status:p.ON_RESET,isValid:t}))}),[]),Ie=r.useCallback((function(e){e.persist();var r=K.current,t=r.isValid,n=r.submitAttempts,a=p.ON_SUBMIT;"string"==typeof q&&t||e.preventDefault();var c=n+1;if(t&&Object.keys(de.current).length>0&&E(ye.current)){var i=function(e,r,t,n){return Object.keys(e).filter((function(e){var t=r[e],n=t.type;return 0===t.counter&&!t.isValid&&"field"===n||"collection"===n})).map((function(r){var u=b(r,t);return e[r](u,t).then((function(e){return n(r,!0,1),e})).catch((function(e){throw n(r,!1,1),e}))}))}(de.current,ye.current,K.current.state,me),o=e.target;e.preventDefault(),W(u({},K.current,{isValid:!1,isSubmitting:!0,submitAttempts:c})),Promise.all(i).then((function(){"string"==typeof q?o.submit():W(u({},K.current,{status:a,isValid:!0}))})).catch((function(){var e=E(ye.current);W(u({},K.current,{isValid:e,isSubmitting:!1}))}))}else W(u({},K.current,{status:a,isSubmitting:!0,submitAttempts:c}))}),[]),Fe=r.useCallback((function(e){var r=e;"function"==typeof e&&(r=e(K.current.state));_e(r,!1)}),[]),xe=r.useRef(!1),Me=r.useRef(null),Te=r.useCallback((function(e,r,t){if(void 0===t&&(t=!0),Me.current!==K.current.state&&null!==ie.current&&(xe.current||n&&t||!n)){xe.current=!0,Me.current=K.current.state;var u=ie.current;F(u.checks,u.isValid)}}),[]),Pe=r.useRef({}),je=r.useCallback((function(e,r){Pe.current[e]=r}),[]),De=r.useCallback((function(){if(Object.keys(Pe.current).length>0){W(u({},K.current,{status:p.ON_INIT_ASYNC}));var e=R(Pe.current);Promise.all(e).then((function(){var e=p.READY,r=h(te.current,K.current.state);W(u({},K.current,{status:e,isValid:r}))})).catch((function(){W(u({},K.current,{status:p.READY,isValid:!1}))}))}}),[]),Ye=r.useCallback((function(e){var r=e.end;if(e.start)W(u({},K.current,{isValid:!1,status:p.ON_RUN_ASYNC}));else if(r){var t=p.ON_ASYNC_END,n=h(te.current,K.current.state)&&g(ye.current);W(u({},K.current,{isValid:n,status:t}))}}),[]);return r.useEffect((function(){var e=K.current,r=e.status,t=e.state,n=e.isValid;if(r===p.ON_RESET)V(t,n),W(u({},K.current,{status:p.RESETTED}));else if(r===p.ON_CHANGE)o(t,n);else if(r===p.ON_INIT)De(),N(t,n);else if(r===p.ON_SUBMIT){var a={isSubmitting:!1,status:p.READY};if(n){var c=O(t,n);if(c&&"function"==typeof c.then)c.then((function(){W(u({},K.current,a,{submitted:K.current.submitted+1}))})).catch((function(){return W(u({},K.current,a))}));else{var i=K.current.submitted;W(u({},K.current,a,{submitted:!1===c?i:i+1}))}}else W(u({},K.current,a))}!Q||r!==p.ON_RESET&&r!==p.ON_CHANGE&&r!==p.ON_INIT&&r!==p.ON_SUBMIT||$(G,t)}),[K.current]),r.useEffect((function(){Z.current=!0,P.length>0&&ne(S,oe.current),"function"==typeof Y&&fe(S,se.current,null);var e=Q&&(null==H(G)||0===Object.keys(H(G)).length)||!Q,r=Q&&H(G)||K.current.state,t=h(te.current,r)&&g(ye.current);K.current=u({},K.current,{state:r,isValid:t,pristine:e,status:p.ON_INIT}),W(K.current)}),[]),r.useEffect((function(){var e=z.status;e===p.ON_RESET?(xe.current=!1,Me.current=!1,M(),D()):e!==p.READY&&e!==p.ON_INIT_ASYNC&&(null!==ie.current&&Te(!1,!0,!1),null===ie.current||ie.current.isValid||D())}),[ce.current,z.status]),u({},z,{formState:z.state,formStatus:z.status,mapFields:he.current,triggerSyncValidation:Te,unRegisterField:be,updateRegisteredField:ge,registerAsyncInitValidation:je,runAsyncValidation:Ye,dispatchNewState:Fe,changeProp:Ee,initProp:Re,onSubmitForm:Ie,removeProp:Ae,stillMounted:ee,reset:Oe,addValidators:ne,removeValidators:ue,addValidatorsAsync:fe,removeValidatorsAsync:ve,updateValidatorsMap:me,registerReset:Ne,unRegisterReset:ke})}var N=r.createContext(),k=r.createContext(),O=function(){var e=r.useContext(k);return{state:e.state,reset:e.reset,isValid:e.isValid,pristine:e.pristine,submitted:e.submitted,submitAttempts:e.submitAttempts,isSubmitting:e.isSubmitting,formStatus:e.formStatus,dispatch:e.dispatchNewState,onSubmitForm:e.onSubmitForm}};function I(){var e=r.useContext(N),t=r.useContext(k);return e||t}function F(e){var t=e.children,c=e.initialState,i=e.onChange,o=e.onInit,s=e.onReset,l=e.onSubmit,d=e.onValidation,f=e.resetSyncErr,v=e.validators,y=e.asyncValidator,m=e.onAsyncValidation,p=e.resetAsyncErr,V=e.reducers,S=e.touched,b=e._getInitilaStateForm_,h=e._onMultipleForm_,g=e.name,E=e.action,R=e.innerRef,A=a(e,["children","initialState","onChange","onInit","onReset","onSubmit","onValidation","resetSyncErr","validators","asyncValidator","onAsyncValidation","resetAsyncErr","reducers","touched","_getInitilaStateForm_","_onMultipleForm_","name","action","innerRef"]),_=C({initialState:c,touched:S,onChange:i,onInit:o,onReset:s,onSubmit:l,onValidation:d,resetSyncErr:f,validators:v,asyncValidator:y,onAsyncValidation:m,resetAsyncErr:p,reducers:V,_getInitilaStateForm_:b,_onMultipleForm_:h,name:g,action:E}),N=_.onSubmitForm,O=a(_,["onSubmitForm"]),I=r.useMemo((function(){return O}),[O.state,O.isValid,O.status,O.pristine,O.isSubmitting,O.submitAttempts,O.submitted]);return n.default.createElement(k.Provider,{value:I},n.default.createElement("form",u({action:E,onSubmit:N},A,{name:g,ref:R}),t))}var x=r.memo(F),M=r.createContext(),T=-1;function P(e){return function(r){var t,u;function a(e){var t;return(t=r.call(this,e)||this).state={id:T+=1,getID:t.getID},t}(t=a).prototype=Object.create((u=r).prototype),t.prototype.constructor=t,t.__proto__=u;var c=a.prototype;return c.getID=function(){return++T},c.render=function(){return n.default.createElement(M.Provider,{value:this.state},n.default.createElement(e,this.props))},a}(r.PureComponent)}var j=function(e,t,n){var u=r.useRef(t),a=r.useContext(M),c=void 0!==a?a.id:1,i=r.useCallback((function(e){u.current=e}),[]);return"array"===e.type&&(void 0!==n?(c=a.getID(),u.current=n):void 0===u.current&&(u.current=e.getIndex(c))),{nameProp:u,uniqueIDarrayContext:c,setNameProp:i}},D=[];function Y(e){var t=I(),n=e.name,c=e.validators,i=void 0===c?D:c,o=e.asyncValidator,s=e.type,l=e.onFocus,v=void 0===l?y:l,V=e.onBlur,S=void 0===V?y:V,b=e.onChange,h=void 0===b?y:b,g=e.onValidation,E=void 0===g?y:g,R=e.resetSyncErr,A=void 0===R?y:R,_=e.resetAsyncErr,C=void 0===_?y:_,N=e.onAsyncValidation,k=e.value,O=void 0===k?"":k,F=e.checked,x=void 0!==F&&F,M=e.touched,T=void 0!==M&&M,P=e.multiple,Y=void 0!==P&&P,B=e.reducers,U=j(t,n,e.index),w=U.nameProp,H=U.uniqueIDarrayContext,$=U.setNameProp,G=t.state,q=r.useRef(null);q.current=t.formState;var L=r.useRef(!1),z=r.useRef(O),J=r.useRef(x),K=r.useRef(""),Q=r.useRef(null),W=r.useRef(null),X=function(e,t,n,u,a,c,i){var o=u,s=a;void 0===t[n.current]||c.current||i.stillMounted()||("radio"!==e&&""===o&&(o=t[n.current]),!1===a&&("checkbox"===e||"radio"===e&&t[n.current]===u)&&(s=!0));var l=r.useRef(o),d=r.useRef(s);return[l,d]}(s,G,w,O,x,L,t),Z=X[0],ee=X[1];!L.current&&Z.current?z.current=Z.current:"checkbox"===s||"radio"===s?(z.current=Z.current,J.current="checkbox"===s?void 0!==G[w.current]||!L.current&&!0===x:G[w.current]===Z.current):"select"===s?z.current=void 0!==G[w.current]?G[w.current]:Y?[]:"":"file"===s?(z.current=G[w.current],K.current=void 0!==G[w.current]?K.current:""):z.current="custom"===s||void 0!==G[w.current]?G[w.current]:"";var re=r.useMemo((function(){return m(B)}),[]),te=r.useCallback((function(e){switch(Q.current=null,W.current=null,s){case"number":case"range":var r=re(""!==Z.current?Number(Z.current):Z.current,z.current,e);return""===r?void 0:r;case"radio":case"checkbox":J.current=ee.current;var t=re(Z.current,z.current,e);return!1===ee.current?void 0:t;default:var n=re(Z.current,z.current,e);return""===n?void 0:n}}),[]),ne=r.useCallback((function(e,r){var n=re(e,z.current,q.current);h(n,r),t.changeProp(w.current,n,!1)}),[]),ue=r.useCallback((function(e){"function"==typeof e.persist&&e.persist();var r,t=e.target;if("select"===s&&Y){var n=t.options;r=[];for(var u=0,a=n.length;a>u;u++)n[u].selected&&r.push(n[u].value)}else"file"===s?(r=Y?function(e){for(var r=[],t=0,n=e.length;n>t;t++)r.push(e[t]);return r}(t.files):t.files[0],K.current=t.value):r="checkbox"===s?!0===J.current?"":Z.current||t.value||!0:"radio"===s?Z.current||t.value||!0:("number"===s||"range"===s)&&""!==t.value?Number(t.value):t.value;ne(r,e)}),[]),ae=r.useCallback((function(e){var r="function"==typeof e?e(z.current):e;ne(r)}),[]);r.useEffect((function(){if(L.current=!0,"array"===t.type&&t.registerIndex(H,$),i.length>0&&t.addValidators(w.current,se.current),t.updateRegisteredField(w.current,ae),"function"==typeof o&&(t.addValidatorsAsync(w.current,le.current,!1),""===O&&""===Z.current||t.registerAsyncInitValidation(w.current,(function(){return Q.current=Z.current,le.current(Z.current).then((function(){t.updateValidatorsMap(w.current,!0,1)})).catch((function(e){throw"cancelled"!==e&&t.updateValidatorsMap(w.current,!1,1),e}))}))),"radio"===s&&!0===ee.current&&t.registerReset(w.current,te),"radio"!==s&&t.registerReset(w.current,te),"checkbox"!==s&&"radio"!==s&&""!==O||("checkbox"===s||"radio"===s)&&x){var e=O;"checkbox"===s?e="checkbox"===s?O||!0:O:"number"!==s&&"range"!==s||(e=Number(e));var r=re(e,O,q.current);t.initProp(w.current,r,e)}return function(){A(),C(),t.stillMounted()&&(t.unRegisterField(w.current),"function"==typeof o&&t.removeValidatorsAsync(w.current,le.current),i.length>0&&t.removeValidators(w.current,se.current),t.removeProp(w.current,{removeCurrent:!0,removeInitial:!0},!0),t.unRegisterReset(w.current),"array"===t.type&&t.removeIndex(H))}}),[]);var ce=d(i),ie=ce.validationMsg,oe=ce.validationObj,se=ce.validationFN,le=f(o,N)[0],de=r.useState((function(){return!1})),fe=de[0],ve=de[1],ye=r.useState((function(){return!1})),me=ye[0],pe=ye[1],Ve=r.useState((function(){return!1})),Se=Ve[0],be=Ve[1];return r.useEffect((function(){if(t.formStatus===p.ON_RESET)ve(!1),be(!1),pe(!1),A(),C();else if(t.formStatus!==p.READY&&t.formStatus!==p.ON_INIT_ASYNC){var e="radio"===s||"checkbox"===s,r="select"===s&&Y;W.current!==z.current&&null!==oe.current&&(!e&&""!==O||"custom"===s&&T&&fe||t.formStatus===p.ON_SUBMIT||!e&&(T&&fe||!T&&r&&(fe||null===W.current)||!T&&!r)||e&&me)&&(W.current=z.current,E(oe.current.checks,oe.current.isValid)),fe&&(null==t||null==t.triggerSyncValidation||t.triggerSyncValidation()),(null!==oe.current&&oe.current.isValid||0===i.length)&&Se&&t.formStatus!==p.ON_SUBMIT&&t.formStatus!==p.ON_INIT_ASYNC&&"function"==typeof o&&Q.current!==z.current&&(Q.current=z.current,t.runAsyncValidation({start:!0}),le.current(z.current).then((function(){t.updateValidatorsMap(w.current,!0,1),t.runAsyncValidation({end:!0})})).catch((function(e){"cancelled"!==e&&(t.updateValidatorsMap(w.current,!1,1),t.runAsyncValidation({end:!0}))})))}}),[ie.current,fe,Se,me,t.formStatus]),function(e){switch(e.type){case"file":var r=e.fileValue;return u({},a(e,["value","setValue","fileValue"]),{value:r});case"select":return a(e,["type","setValue","fileValue"]);case"custom":return a(e,["fileValue"]);default:return a(e,["fileValue","setValue"])}}({onChange:ue,onBlur:r.useCallback((function(e){e.persist(),be(!0),ve(!0),S(e)}),[]),onFocus:r.useCallback((function(e){e.persist(),ve(!1),be(!1),pe(!0),v(e)}),[]),checked:J.current,value:z.current,fileValue:K.current,type:s,name:n,multiple:Y,setValue:ae})}var B=P((function(e){var r=e.onFocus,t=e.onBlur,c=e.onChange,i=e.name,o=e.index,s=e.checked,l=e.validators,d=e.asyncValidator,f=e.onValidation,v=e.onAsyncValidation,y=e.resetSyncErr,m=e.resetAsyncErr,p=e.type,V=e.value,S=e.touched,b=e.multiple,h=e.reducers,g=e.innerRef,E=a(e,["onFocus","onBlur","onChange","name","index","checked","validators","asyncValidator","onValidation","onAsyncValidation","resetSyncErr","resetAsyncErr","type","value","touched","multiple","reducers","innerRef"]),R=Y({onFocus:r,onBlur:t,onChange:c,type:p,name:i,index:o,checked:s,value:V,validators:l,asyncValidator:d,onValidation:f,onAsyncValidation:v,reducers:h,resetSyncErr:y,resetAsyncErr:m,touched:S,multiple:b});return n.default.createElement("input",u({},E,R,{ref:g}))})),U=P((function(e){var r=e.onFocus,t=e.onBlur,c=e.onChange,i=e.children,o=e.name,s=e.index,l=e.validators,d=e.asyncValidator,f=e.onValidation,v=e.onAsyncValidation,y=e.resetSyncErr,m=e.resetAsyncErr,p=e.multiple,V=e.value,S=e.touched,b=e.reducers,h=e.innerRef,g=a(e,["onFocus","onBlur","onChange","children","name","index","validators","asyncValidator","onValidation","onAsyncValidation","resetSyncErr","resetAsyncErr","multiple","value","touched","reducers","innerRef"]),E=Y({onFocus:r,onBlur:t,onChange:c,type:"select",name:o,index:s,value:V,validators:l,asyncValidator:d,onValidation:f,onAsyncValidation:v,resetSyncErr:y,resetAsyncErr:m,touched:S,multiple:p,reducers:b});return n.default.createElement("select",u({},g,E,{ref:h}),i)})),w=P((function(e){var r=e.onFocus,t=e.onBlur,c=e.onChange,i=e.name,o=e.index,s=e.validators,l=e.asyncValidator,d=e.onValidation,f=e.onAsyncValidation,v=e.resetSyncErr,y=e.resetAsyncErr,m=e.value,p=e.touched,V=e.reducers,S=e.innerRef,b=a(e,["onFocus","onBlur","onChange","name","index","validators","asyncValidator","onValidation","onAsyncValidation","resetSyncErr","resetAsyncErr","value","touched","reducers","innerRef"]),h=Y({onFocus:r,onBlur:t,onChange:c,type:"text",name:i,index:o,value:m,validators:s,asyncValidator:l,onValidation:d,onAsyncValidation:f,resetSyncErr:v,resetAsyncErr:y,touched:p,reducers:V});return n.default.createElement("textarea",u({},b,h,{ref:S}))})),H=[],$={},G=[];function q(e){var t=I(),n=e.type,a=e.value,c=e.reducers,o=e.validators,l=void 0===o?G:o,S=e.onValidation,b=void 0===S?y:S,h=e.resetSyncErr,g=void 0===h?y:h,E=e.resetAsyncErr,R=void 0===E?y:E,A=e.asyncValidator,_=e.onAsyncValidation,C=void 0===_?y:_,N=e.touched,k=void 0!==N&&N,O=j(t,e.name,e.index),F=O.nameProp,x=O.uniqueIDarrayContext,M=O.setNameProp,T=s(F,t,n),P=T.unRegisterField,D=T.mapFields,Y=T.updateRegisteredField,B=r.useMemo((function(){return m(c)}),[]),U=r.useRef(!1),w=r.useCallback((function(){return U.current}),[]),q=n&&"array"===n,L=a||(q?H:$),z=r.useRef(L),J=r.useRef(L),K=r.useRef(q?H:$),Q=r.useRef(null);z.current=U.current?t.state[F.current]||(q?H:$):a||t.state[F.current]||L;var W=r.useRef(null);W.current=t.formState;var X=r.useRef(q?[]:{}),Z=r.useCallback((function(e,r){X.current=q?[].concat(X.current):u({},X.current),q&&void 0!==X.current[e]?X.current.splice(Number(e),0,r):X.current[e]=r}),[]),ee=r.useCallback((function(e){X.current.constructor===Array?X.current.splice(e,1):delete X.current[e]}),[]),re=r.useCallback((function(e){Q.current=null;var r=q?[]:{},t=Object.keys(X.current).reduce((function(r,t){var n=X.current[t](e);return void 0!==n&&(r[t]=n),r}),r),n=B(t,J.current,e);return n=void 0!==n&&Object.keys(n).length>0?n:void 0}),[]),te=r.useCallback((function(e){var r=B(e,z.current,W.current);t.changeProp(F.current,r,0===Object.keys(r).length)}),[]),ne=r.useCallback((function(e,r,t){var n=v(z.current,{value:r,nameProp:e,removeMe:t});te(n)}),[]),ue=r.useCallback((function(e,r,n,u){void 0===u&&(u=!0);var a=v(z.current,{value:r,nameProp:e,add:U.current&&u});J.current=v(J.current,{value:n,nameProp:e,add:U.current&&u});var c=B(a,z.current,W.current);K.current=a,U.current?t.initProp(F.current,c,J.current,!1):z.current=c}),[]),ae=r.useRef((function(e,r,n){var u=r.initialState,a=r.removeInitial;void 0===n&&(n=!1);var c=v(z.current,{value:r.currentState,nameProp:e,removeMe:r.removeCurrent}),i=v(J.current,{value:u,nameProp:e,removeMe:a});n&&q&&(c=c.filter((function(r,t){return t!==e})),i=i.filter((function(r,t){return t!==e})));var o=B(c,z.current,W.current);z.current=o,J.current=i,t.removeProp(F.current,{currentState:z.current,removeCurrent:0===Object.keys(z.current).length,initialState:J.current,removeInitial:0===Object.keys(J.current).length})})).current,ce=r.useCallback((function(e){var r="function"==typeof e?e(z.current):e;te(r)}),[]),ie=i(t,F,U),oe=ie[0],se=ie[1],le=ie[2],de=i(t,F,U,!0),fe=de[0],ve=de[1],ye=de[2],me=de[3],pe=de[4],Ve=d(l),Se=Ve.validationMsg,be=Ve.validationObj,he=Ve.validationFN,ge=f(A,C)[0],Ee=r.useCallback((function(e,r){if(void 0===e&&(e=!0),void 0===r&&(r=!1),Q.current!==z.current){if(null!==be.current&&(k||r)){Q.current=z.current;var n=be.current;b(n.checks,n.isValid)}e&&(null==t||null==t.triggerSyncValidation||t.triggerSyncValidation())}}),[]);r.useEffect((function(){t.formStatus===p.ON_RESET?(g(),R()):t.formStatus!==p.READY&&t.formStatus!==p.ON_INIT_ASYNC&&(null!==be.current&&t.formStatus===p.ON_SUBMIT&&Ee(!1,!0),null===be.current||be.current.isValid||R())}),[Se.current,t.formStatus]);var Re=r.useRef({}),Ae=r.useCallback((function(e,r){Re.current[e]=r}),[]);r.useEffect((function(){U.current=!0,"array"===t.type&&t.registerIndex(x,M),l.length>0&&t.addValidators(F.current,he.current),"function"==typeof A&&t.addValidatorsAsync(F.current,ge.current,null),D.current[V]=ce,t.updateRegisteredField(F.current,D.current),Object.keys(Re.current).length>0&&t.registerAsyncInitValidation(F.current,Re.current),Object.keys(oe.current).length>0&&t.addValidators(F.current,oe.current),Object.keys(fe.current).length>0&&t.addValidatorsAsync(F.current,fe.current,me.current),t.registerReset(F.current,re);var e=B(z.current,K.current,W.current);return t.initProp(F.current,e,J.current),function(){g(),R(),U.current=!1,t.stillMounted()&&(t.unRegisterField(F.current),"function"==typeof A&&t.removeValidatorsAsync(F.current,ge.current,!1),l.length>0&&t.removeValidators(F.current,he.current),Object.keys(oe.current).length>0&&t.removeValidators(F.current,oe.current),Object.keys(fe.current).length>0&&t.removeValidatorsAsync(F.current,fe.current,me.current),t.removeProp(F.current,{removeCurrent:!0,removeInitial:!0},!0),t.unRegisterReset(F.current),"array"===t.type&&t.removeIndex(x))}}),[]);var _e=r.useRef({}),Ce=r.useCallback((function(e){return void 0===_e.current[e]&&(_e.current[e]=null),Object.keys(_e.current).length-1}),[]),Ne=r.useCallback((function(e){delete _e.current[e],Object.keys(_e.current).forEach((function(e,r){return _e.current[e](r)}))}),[]),ke=r.useCallback((function(e,r){_e.current[e]=r}),[]);return{state:z.current,formState:t.formState,formStatus:t.formStatus,runAsyncValidation:t.runAsyncValidation,unRegisterField:P,updateRegisteredField:Y,registerAsyncInitValidation:Ae,changeProp:ne,initProp:ue,removeProp:ae,stillMounted:w,getIndex:Ce,removeIndex:Ne,registerIndex:ke,type:n,addValidators:se,removeValidators:le,addValidatorsAsync:ve,removeValidatorsAsync:ye,updateValidatorsMap:pe,registerReset:Z,unRegisterReset:ee,triggerSyncValidation:Ee}}var L=P((function(e){var t=e.children,u=q({name:e.name,index:e.index,touched:e.touched,type:e.object?"object":"array",value:e.value,reducers:e.reducers,onValidation:e.onValidation,validators:e.validators,resetSyncErr:e.resetSyncErr,asyncValidator:e.asyncValidator,onAsyncValidation:e.onAsyncValidation,resetAsyncErr:e.resetAsyncErr}),a=r.useMemo((function(){return u}),[u.state,u.formStatus]);return n.default.createElement(N.Provider,{value:a},t)})),z=r.memo((function(e){var t=e.children,u=C({initialState:e.initialState,onChange:e.onChange,onInit:e.onInit,onReset:e.onReset,onSubmit:e.onSubmit,onValidation:e.onValidation,resetSyncErr:e.resetSyncErr,validators:e.validators,asyncValidator:e.asyncValidator,onAsyncValidation:e.onAsyncValidation,resetAsyncErr:e.resetAsyncErr,touched:e.touched,reducers:e.reducers,_getInitilaStateForm_:e._getInitilaStateForm_,_onMultipleForm_:e._onMultipleForm_,name:e.name,action:e.action}),a=r.useMemo((function(){return u}),[u.state,u.isValid,u.status,u.pristine,u.isSubmitting,u.submitAttempts,u.submitted]);return n.default.createElement(k.Provider,{value:a},t)})),J={error:void 0,isValid:!0};var K={status:void 0,value:void 0};function Q(e){return Object.keys(e).reduce((function(r,t){return u({},r,e[t])}),{})}e.Collection=L,e.Form=x,e.FormContext=z,e.Input=B,e.STATUS=p,e.Select=U,e.TextArea=w,e.default=x,e.getValueByPath=b,e.useAsyncValidation=function(e){var t=r.useState((function(){return u({},K)})),n=t[0],a=t[1];return[n,{onAsyncValidation:function(e){return a(u({},n,e))},asyncValidator:e,resetAsyncErr:function(){return a(u({},K))}}]},e.useChildren=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=y);var n=r.useState((function(){return e})),u=n[0],a=n[1],c=O().formStatus;return r.useEffect((function(){c===p.ON_RESET&&(a([]),t())}),[c]),[u,a]},e.useCollection=function(e){var t=q({name:e.name,index:e.index,type:e.type,value:e.value,reducers:e.reducers,onValidation:e.onValidation,validators:e.validators,resetSyncErr:e.resetSyncErr,asyncValidator:e.asyncValidator,onAsyncValidation:e.onAsyncValidation,resetAsyncErr:e.resetAsyncErr}),n=t.changeProp,u=t.state,a=t.formState;return{updateCollection:r.useCallback((function(e,r){return n(e,r)}),[]),value:u,state:a}},e.useField=Y,e.useForm=O,e.useMultipleForm=function(e){var t=r.useRef({}),n=r.useRef((function(r,n){t.current[r]=n,"function"==typeof e&&e(Q(t.current))})).current,u=r.useRef((function(e){return t.current[e]})).current;return[r.useRef((function(){return Q(t.current)})).current,{_getInitilaStateForm_:u,_onMultipleForm_:n}]},e.useSelector=function(e){var t,n,u=r.useContext(k),a=u.state,c=u.mapFields;try{t=e(a)}catch(e){t=void 0}try{var i=e(c);n=(null==i?void 0:i[V])||i}catch(e){n=void 0}return[t,n]},e.useValidation=function(e){void 0===e&&(e=[]);var t=r.useState((function(){return u({},J)})),n=t[1];return[t[0],{onValidation:function(e,r){return n({error:l(e),isValid:r})},validators:e,resetSyncErr:function(){return n(u({},J))}}]},e.withIndex=P,Object.defineProperty(e,"__esModule",{value:!0})}));
